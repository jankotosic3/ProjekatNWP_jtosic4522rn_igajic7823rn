<div class="container bg-dark text-light p-4 rounded-4 shadow-lg mt-4">
  <h4 class="mb-3 border-bottom border-secondary pb-2">User Table</h4>

  <table
    class="table table-dark table-hover align-middle mb-4 rounded-3 overflow-hidden"
  >
    <thead class="table-secondary text-dark">
      <tr>
        <th scope="col">#</th>
        <th scope="col">Name</th>
        <th scope="col">Surname</th>
        <th scope="col">Email</th>
        <th scope="col">Can make new user</th>
        <th scope="col">Can delete a user</th>
        <th scope="col">Can update a user</th>
        <th scope="col">Can read user data</th>
        @if(userLoggedIn?.deleteUserPermission) {
        <th scope="col">Delete user</th>
        }
      </tr>
    </thead>
    <tbody>
      @for (user of users; track user.id) {
      <tr (click)="onRowClick(user)">
        <th scope="row">{{ user.id }}</th>
        <td>{{ user.name }}</td>
        <td>{{ user.surname }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.newUserPermission }}</td>
        <td>{{ user.deleteUserPermission }}</td>
        <td>{{ user.updateUserPermission }}</td>
        <td>{{ user.readUserPermission }}</td>
        @if(userLoggedIn?.deleteUserPermission) {
          <button type="button" class="btn btn-danger fw-semibold px-4" (click)="openDeleteUserDialog(user); $event.stopPropagation()">Delete</button>
          <!-- $event.stopPropagation() sprecava da se pozove onRowClick(), tj da se odradi funkcija parent komponente -->
        }
      </tr>
      }
    </tbody>
  </table>
  @if(userLoggedIn?.newUserPermission) {
  <div class="text-end">
    <button
      type="button"
      class="btn btn-info fw-semibold px-4"
      (click)="onNewUser()"
    >
      + Add new user
    </button>
  </div>
  } 
    
  @if(selectedUser && userLoggedIn?.updateUserPermission) {
  <app-edit-user-data [selectedUser]="selectedUser" (closeDialog)="closeUpdateUserDialog()"/>
  }

  @if(showDeleteUserDialog && userToDelete && userLoggedIn?.deleteUserPermission) {
    <app-delete-user [user]="userToDelete" (closeDialog)="closeDeleteUserDialog()"/>
  }

</div>
